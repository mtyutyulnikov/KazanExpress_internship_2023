# Ð¢ÐµÑÑ‚Ð¾Ð²Ð¾Ðµ Ð¾Ñ‚ KazanExpress! ðŸ›’

## **Ð—Ð°Ð´Ð°Ñ‡Ð°**

ÐÐ° Ð½Ð°ÑˆÐµÐ¼ Ð¼Ð°Ñ€ÐºÐµÑ‚Ð¿Ð»ÐµÐ¹ÑÐµ ÐµÐ¶ÐµÐ´Ð½ÐµÐ²Ð½Ð¾ Ð¿Ð¾ÑÐ²Ð»ÑÑŽÑ‚ÑÑ ÑÐ¾Ñ‚Ð½Ð¸ Ð½Ð¾Ð²Ñ‹Ñ… Ñ‚Ð¾Ð²Ð°Ñ€Ð¾Ð². ÐžÐ´Ð½Ð°ÐºÐ¾, Ð¿Ñ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ Ð¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ð¾ÑÑ‚ÑŒ Ð·Ð°Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ñ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ð¸ Ð¾Ð±Ð¾ Ð²ÑÐµÑ… Ñ‚Ð¾Ð²Ð°Ñ€Ð°Ñ… ÑÑ€Ð°Ð·Ñƒ Ð½ÐµÐ²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾. ÐÐµÐ²ÐµÑ€Ð½Ð¾ Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð½Ð°Ñ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ Ð·Ð°Ñ‡Ð°ÑÑ‚ÑƒÑŽ Ð¿Ñ€Ð¸Ð²Ð¾Ð´Ð¸Ñ‚ Ðº Ð¿Ð¾Ñ‚ÐµÐ½Ñ†Ð¸Ð°Ð»ÑŒÐ½Ð¾ ÑƒÐ¿ÑƒÑ‰ÐµÐ½Ð½Ð¾Ð¹ Ð¿Ñ€Ð¸Ð±Ñ‹Ð»Ð¸ ÐºÐ°Ðº ÑÐ¾ ÑÑ‚Ð¾Ñ€Ð¾Ð½Ñ‹ Ð¿Ñ€Ð¾Ð´Ð°Ð²Ñ†Ð°, Ñ‚Ð°Ðº Ð¸ ÑÐ¾ ÑÑ‚Ð¾Ñ€Ð¾Ð½Ñ‹ Ð¼Ð°Ñ€ÐºÐµÑ‚Ð¿Ð»ÐµÐ¹ÑÐ°. ÐœÑ‹ Ñ…Ð¾Ñ‚Ð¸Ð¼ Ð½Ð°ÑƒÑ‡Ð¸Ñ‚ÑŒÑÑ Ð¿Ñ€ÐµÐ´ÑÐºÐ°Ð·Ñ‹Ð²Ð°Ñ‚ÑŒ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸ÑŽ Ð½Ð° Ð¾ÑÐ½Ð¾Ð²Ðµ Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ñ, ÐºÐ°Ñ€Ñ‚Ð¸Ð½ÐºÐ¸ Ð¸ Ð´Ñ€ÑƒÐ³Ð¸Ñ… Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ð°Ñ… Ñ‚Ð¾Ð²Ð°Ñ€Ð¾Ð².

### **Ð¤Ð¾Ñ€Ð¼Ð°Ñ‚ Ð²Ñ…Ð¾Ð´Ð½Ñ‹Ñ… Ð´Ð°Ð½Ð½Ñ‹Ñ…**

**train.parquet** - `pandas.DataFrame` Ñ Ñ‚Ð¾Ð²Ð°Ñ€Ð°Ð¼Ð¸ Ð½Ð° Ð¼Ð°Ñ€ÐºÐµÑ‚Ð¿Ð»ÐµÐ¹ÑÐµ. Ð£ ÐºÐ°Ð¶Ð´Ð¾Ð³Ð¾ Ñ‚Ð¾Ð²Ð°Ñ€Ð° ÐµÑÑ‚ÑŒ:

- *product_id* - *Ð¸Ð´ÐµÐ½Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ‚Ð¾Ñ€ Ñ‚Ð¾Ð²Ð°Ñ€Ð°*
- **text_fields -** ÑÑ‚Ñ€Ð¾ÐºÐ°-ÑÐ»Ð¾Ð²Ð°Ñ€ÑŒ ÑÐ¾ ÑÐ»ÐµÐ´ÑƒÑŽÑ‰Ð¸Ð¼Ð¸ Ð¿Ð¾Ð»ÑÐ¼Ð¸:
    - *title - Ð·Ð°Ð³Ð¾Ð»Ð¾Ð²Ð¾Ðº*
    - *description - Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ðµ*
    - **attributes - Ð½Ð° ÑÐ°Ð¹Ñ‚Ðµ Ð¾Ð½Ð¸ Ð½Ð°Ñ…Ð¾Ð´ÑÑ‚ÑÑ Ð² ÐºÐ°Ñ€Ñ‚Ð¾Ñ‡ÐºÐµ Ñ‚Ð¾Ð²Ð°Ñ€Ð°**
    - *custom_characteristics, defined_characteristics, filters - Ð²Ð»Ð¾Ð¶ÐµÐ½Ð½Ñ‹Ðµ ÑÐ»Ð¾Ð²Ð°Ñ€Ð¸ Ñ ÐºÐ»ÑŽÑ‡Ð°Ð¼Ð¸ â€“ Ð½Ð°Ð·Ð²Ð°Ð½Ð¸ÑÐ¼Ð¸ Ð¿Ð¾Ð»ÐµÐ¹-Ð¿Ñ€Ð¸Ð·Ð½Ð°ÐºÐ¾Ð² Ð¸ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸ÑÐ¼Ð¸ â€“ Ð²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ñ‹Ð¼Ð¸ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸ÑÐ¼Ð¸ ÑÑ‚Ð¸Ñ… Ð¿Ñ€Ð¸Ð·Ð½Ð°ÐºÐ¾Ð² (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, Ð¦Ð²ÐµÑ‚: Ð‘ÐµÐ»Ñ‹Ð¹ / Ð§ÐµÑ€Ð½Ñ‹Ð¹)*
- *rating - ÑÑ€ÐµÐ´Ð½Ð¸Ð¹ Ñ€ÐµÐ¹Ñ‚Ð¸Ð½Ð³ Ñ‚Ð¾Ð²Ð°Ñ€Ð°*
- ***sale*** - *Ñ„Ð»Ð°Ð³, Ð¾Ð±Ð¾Ð·Ð½Ð°Ñ‡Ð°ÑŽÑ‰Ð¸Ð¹ Ð½Ð°Ñ…Ð¾Ð´Ð¸Ñ‚ÑÑ Ð»Ð¸ Ñ‚Ð¾Ð²Ð°Ñ€ Ð² Ñ€Ð°ÑÐ¿Ñ€Ð¾Ð´Ð°Ð¶Ðµ*
- *shop_id (seller_id) - id Ð¼Ð°Ð³Ð°Ð·Ð¸Ð½Ð° (id-Ð¿Ñ€Ð¾Ð´Ð°Ð²Ñ†Ð°)*
- **shop_title** - *Ð½Ð°Ð·Ð²Ð°Ð½Ð¸Ðµ Ð¼Ð°Ð³Ð°Ð·Ð¸Ð½Ð°*
- *category_id - ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ Ñ‚Ð¾Ð²Ð°Ñ€Ð° (Ñ‚Ð°Ñ€Ð³ÐµÑ‚)*
- ***category_name - Ð½Ð°Ð·Ð²Ð°Ð½Ð¸Ðµ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸ Ñ‚Ð¾Ð²Ð°Ñ€Ð° Ñ Ñ‚Ð¾Ñ‡ÐºÐ¸ Ð·Ñ€ÐµÐ½Ð¸Ñ Ð´ÐµÑ€ÐµÐ²Ð° ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¹ KazanExpress***

**test.parquet** - Ñ„Ð°Ð¹Ð», Ð¸Ð´ÐµÐ½Ñ‚Ð¸Ñ‡Ð½Ñ‹Ð¹ **train.parquet**, Ð½Ð¾ Ð±ÐµÐ· Ñ€ÐµÐ°Ð»ÑŒÐ½Ð¾Ð³Ð¾ *category_id*, Ð¸Ð¼ÐµÐ½Ð½Ð¾ ÐµÐ³Ð¾ Ð²Ð°Ð¼ Ð¸ Ð¿Ñ€ÐµÐ´ÑÑ‚Ð¾Ð¸Ñ‚ Ð¿Ñ€ÐµÐ´ÑÐºÐ°Ð·Ð°Ñ‚ÑŒ.

**images**â€“ Ð¿Ð°Ð¿ÐºÐ° Ñ Ð´Ð²ÑƒÐ¼Ñ Ð¿Ð¾Ð´Ð¿Ð°Ð¿ÐºÐ°Ð¼Ð¸: **train** Ð¸ **test** Ð´Ð»Ñ ÐºÐ°Ñ€Ñ‚Ð¸Ð½Ð¾Ðº Ñ‚Ð¾Ð²Ð°Ñ€Ð¾Ð² Ð¸Ð·, ÑÐ¾Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²ÐµÐ½Ð½Ð¾,  Ð¾Ð±ÑƒÑ‡Ð°ÑŽÑ‰ÐµÐ¹ Ð¸ Ñ‚ÐµÑÑ‚Ð¾Ð²Ð¾Ð¹ Ð²Ñ‹Ð±Ð¾Ñ€ÐºÐ¸. ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ñ Ñ„Ð°Ð¹Ð»Ð¾Ð² ÑÐ¾Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²ÑƒÑŽÑ‚ ***product_id*** Ñ‚Ð¾Ð²Ð°Ñ€Ð¾Ð². 



# ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ Ñ€ÐµÑˆÐµÐ½Ð¸Ñ

## ÐŸÑ€ÐµÐ¿Ñ€Ð¾Ñ†ÐµÑÑÐ¸Ð½Ð³ 

Ð”Ð°Ð½Ð½Ñ‹Ðµ Ñ‚Ð°Ð±Ð»Ð¸Ñ† Ð±Ñ‹Ð»Ð¸ Ð¿Ñ€ÐµÐ´Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚Ð°Ð½Ñ‹ (Ð¿Ð¾Ð´Ñ€Ð¾Ð±Ð½ÐµÐµ Ð² Ñ„Ð°Ð¹Ð»Ðµ *data_preprocess.ipynb*) 

* Ð˜Ð· ÑÑ‚Ð¾Ð»Ð±Ñ†Ð° text_fields Ñ€Ð°ÑÐ¿Ð°Ñ€ÑˆÐµÐ½Ñ‹ Ð¿Ð¾Ð»Ñ ÑÐ»Ð¾Ð²Ð°Ñ€Ñ Ð² Ð¾Ñ‚Ð´ÐµÐ»ÑŒÐ½Ñ‹Ðµ ÑÑ‚Ð¾Ð»Ð±Ñ†Ñ‹ (*title*, *description* Ð¸ Ð´Ñ€ÑƒÐ³Ð¸Ðµ)

* Ð˜Ð· ÑÑ‚Ð¾Ð»Ð±Ñ†Ð° *description* ÑƒÐ´Ð°Ð»ÐµÐ½Ñ‹ html Ñ‚ÐµÐ³Ð¸

* Ð˜Ð· ÑÑ‚Ð¾Ð»Ð±Ñ†Ð¾Ð² *title*, *description* ÑƒÐ´Ð°Ð»ÐµÐ½Ñ‹:
    + Ð¡Ð»Ð¾Ð²Ð°, Ð²ÐºÐ»ÑŽÑ‡Ð°ÑŽÑ‰Ð¸Ðµ Ð² ÑÐµÐ±Ñ Ñ†Ð¸Ñ„Ñ€Ñ‹ (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, A22)
    + ÐžÑ‚Ð´ÐµÐ»ÑŒÐ½Ð¾ ÑÑ‚Ð¾ÑÑ‰Ð¸Ðµ Ð·Ð½Ð°ÐºÐ¸ Ð¿Ñ€ÐµÐ¿Ð¸Ð½Ð°Ð½Ð¸Ñ
    + &nbsp
    + Ð­Ð¼Ð¾Ð´Ð·Ð¸
    + Ð¡ÑÑ‹Ð»ÐºÐ¸ (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, Ð½Ð° youtube)
    + ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ñ Ð² ÐºÐ°Ð²Ñ‹Ñ‡ÐºÐ°Ñ…
    + Ð¡Ð»Ð¾Ð²Ð° "ÑˆÑ‚", "ÑÐ¼"
    + ÐÐµÑÐºÐ¾Ð»ÑŒÐºÐ¾ Ð¿Ñ€Ð¾Ð±ÐµÐ»Ð¾Ð² Ð¿Ð¾Ð´Ñ€ÑÐ´, Ð¿Ñ€Ð¾Ð±ÐµÐ»Ñ‹ Ñ ÐºÐ¾Ð½Ñ†Ð° Ð¸ Ð½Ð°Ñ‡Ð°Ð»Ð° ÑÑ‚Ñ€Ð¾ÐºÐ¸

* Ð˜Ð· Ð´Ð°Ñ‚Ð°ÑÐµÑ‚Ð° ÑƒÐ´Ð°Ð»ÐµÐ½Ñ‹ ÐºÐ»Ð°ÑÑÑ‹, Ð² ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ñ… Ð¼ÐµÐ½ÑŒÑˆÐµ 10 ÑÐµÐ¼Ð¿Ð»Ð¾Ð²

* Ð˜Ð· category_name Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½ ÑÑ‚Ð¾Ð»Ð±ÐµÑ† *last_category* - Ð½Ð°Ð·Ð²Ð°Ð½Ð¸Ðµ Ð¿Ð¾ÑÐ»ÐµÐ´Ð½ÐµÐ³Ð¾ Ð¿Ð¾Ð´Ð¿ÑƒÐ½ÐºÑ‚Ð° Ð² ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸ (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, Ð´Ð»Ñ 'Ð’ÑÐµ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸->Ð­Ð»ÐµÐºÑ‚Ñ€Ð¾Ð½Ð¸ÐºÐ°->ÐžÑ„Ð¸ÑÐ½Ð°Ñ Ñ‚ÐµÑ…Ð½Ð¸ÐºÐ°->ÐšÐ¾Ð¼Ð¿Ð»ÐµÐºÑ‚ÑƒÑŽÑ‰Ð¸Ðµ Ð´Ð»Ñ Ð¾Ñ„Ð¸ÑÐ½Ð¾Ð¹ Ñ‚ÐµÑ…Ð½Ð¸ÐºÐ¸->Ð§ÐµÑ€Ð½Ð¸Ð»Ð°' ÑÑ‚Ð¾ 'Ð§ÐµÑ€Ð½Ð¸Ð»Ð°'). Ð¡Ð»Ð¾Ð²Ð° Ð² ÑÑ‚Ð¾Ð»Ð±Ñ†Ðµ *last_category* Ð¿Ñ€Ð¸Ð²ÐµÐ´ÐµÐ½Ñ‹ Ðº Ð½Ð°Ñ‡Ð°Ð»ÑŒÐ½Ð¾Ð¼Ñƒ Ð²Ð¸Ð´Ñƒ

* ÐÐ° Ð¾ÑÐ½Ð¾Ð²Ðµ ÑÑ‚Ð¾Ð»Ð±Ñ†Ð° *last_category* Ð¿Ð¾ÑÑ‡Ð¸Ñ‚Ð°Ð½ Ð½Ð°Ð±Ð¾Ñ€ ÑÐ»Ð¾Ð²-Ñ‚ÐµÐ³Ð¾Ð² (set(df_train['last_category']))

* Ð¡Ð³ÐµÐ½ÐµÑ€Ð¸Ñ€Ð¾Ð²Ð°Ð½Ñ‹ Ð±Ð¸Ð½Ð°Ñ€Ð½Ñ‹Ðµ ÑÑ‚Ð¾Ð»Ð±Ñ†Ñ‹ *title_has_{tag}* Ð½Ð° Ð¾ÑÐ½Ð¾Ð²Ðµ Ð²Ñ…Ð¾Ð¶Ð´ÐµÐ½Ð¸Ðµ Ð² *title* Ñ‚Ð¾Ð³Ð¾ Ð¸Ð»Ð¸ Ð¸Ð½Ð¾Ð³Ð¾ Ñ‚ÑÐ³Ð°

* ÐÑƒÐ¼ÐµÑ€Ð°Ñ†Ð¸Ñ ÐºÐ»Ð°ÑÑÐ¾Ð² Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð° Ð½Ð° 0-730 Ð¸ Ð·Ð°Ð¿Ð¸ÑÐ°Ð½Ð° Ð² ÑÑ‚Ð¾Ð»Ð±ÐµÑ† *target* Ð´Ð»Ñ ÑƒÐ´Ð¾Ð±ÑÑ‚Ð²Ð° Ð¾Ð±ÑƒÑ‡ÐµÐ½Ð¸Ñ Ð½ÐµÐ¹Ñ€Ð¾ÑÐµÑ‚Ð¸


## ÐÐµÐ¹Ñ€Ð¾ÑÐµÑ‚ÑŒ

Ð’ ÐºÐ°Ñ‡ÐµÑÑ‚Ð²Ðµ Ð½ÐµÐ¹Ñ€Ð¾ÑÐµÑ‚Ð¸ Ð±Ñ‹Ð»Ð° Ð²Ñ‹Ð±Ñ€Ð°Ð½Ð° Ð¼Ð¾Ð´ÐµÐ»ÑŒ [rubert-tiny2](https://huggingface.co/cointegrated/rubert-tiny2), Ð¸Ð¼ÐµÑŽÑ‰Ð°Ñ 29Ðœ Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ð¾Ð², Ð¿Ñ€ÐµÐ´Ð¾Ð±ÑƒÑ‡ÐµÐ½Ð½Ð°Ñ Ð½Ð° Ð±Ð¾Ð»ÑŒÑˆÐ¾Ð¼ ÐºÐ¾Ñ€Ð¿ÑƒÑÐµ Ð¸ ÑÐ²Ð»ÑÑŽÑ‰Ð°ÑÑÑ Ð¿Ð¾ ÑÑƒÑ‚Ð¸ Ð¼Ð°Ð»ÐµÐ½ÑŒÐºÐ¾Ð¹ Ð²ÐµÑ€ÑÐ¸ÐµÐ¹ RuBERT. 

ÐÐ° Ð²Ñ…Ð¾Ð´ Ð½ÐµÐ¹Ñ€Ð¾Ð½Ð½Ð¾Ð¹ ÑÐµÑ‚Ð¸ Ð¿Ð¾Ð´Ð°Ð²Ð°Ð»Ð¸ÑÑŒ title Ð¸ description Ñ€Ð°Ð·Ð´ÐµÐ»ÐµÐ½Ð½Ñ‹Ðµ Ñ‚Ð¾Ñ‡ÐºÐ¾Ð¹ Ð¸ Ð¿Ñ€Ð¾Ð±ÐµÐ»Ð¾Ð¼. 

Ð’ ÐºÐ°Ñ‡ÐµÑÑ‚Ð²Ðµ Ð¼Ð¾Ð´ÐµÐ»Ð¸ Ð´Ð»Ñ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸ Ð¸Ð·Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ð¹ Ð±Ñ‹Ð»Ð° Ð¿Ð¾Ð¿Ñ‹Ñ‚ÐºÐ° Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ Resnet18 Ð¸Ð»Ð¸ EfficientNetV2_S, Ð¿Ñ€ÐµÐ´Ð¾Ð±ÑƒÑ‡ÐµÐ½Ð½Ñ‹Ðµ Ð½Ð° ImageNet_1K. ÐžÐ´Ð½Ð°ÐºÐ¾ Ð±Ñ‹Ð»Ð¸ Ð¿Ñ€Ð¾Ð²ÐµÐ´ÐµÐ½Ñ‹ Ñ€ÑÐ´ [ÑÐºÑÐ¿ÐµÑ€Ð¸Ð¼ÐµÐ½Ñ‚Ð¾Ð²](https://wandb.ai/mtyutyulnikov/KazanExpress/) Ð¿Ð¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÑŽÑ‰Ð¸Ðµ, Ñ‡Ñ‚Ð¾ Ñ‚Ð¾Ñ‡Ð½Ð¾ÑÑ‚ÑŒ Ð½ÐµÐ¹Ñ€Ð¾ÑÐµÑ‚Ð¸, Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÑŽÑ‰ÐµÐ¹ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð½Ð° Ñ‚ÐµÐºÑÑ‚Ð°Ñ…, Ð²Ñ‹ÑˆÐµ, Ñ‡ÐµÐ¼ Ð½Ð° Ñ‚ÐµÐºÑÐ°Ñ… Ð¸ Ð¸Ð·Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸ÑÑ…. Ð’Ð¸Ð´Ð¸Ð¼Ð¾ ÑÑ‚Ð¾ Ð¾Ð±ÑƒÑÐ»Ð¾Ð²Ð»ÐµÐ½Ð¾ Ð½ÐµÐ¾Ð´Ð½Ð¾Ð·Ð½Ð°Ñ‡Ð½Ð¾ÑÑ‚ÑŒÑŽ Ñ‚Ð¾Ð³Ð¾, Ð¾ Ñ‡ÐµÐ¼ Ð¸Ð¼ÐµÐ½Ð½Ð¾ Ð½Ð° ÐºÐ°Ñ€Ñ‚Ð¸Ð½ÐºÐµ Ð¸Ð´ÐµÑ‚ Ñ€ÐµÑ‡ÑŒ.

Ð­Ð¼Ð±ÐµÐ´Ð¸Ð½Ð³ Ñ‚ÐµÐºÑÑ‚Ð° Ñ€Ð°Ð·Ð¼ÐµÑ€Ð½Ð¾ÑÑ‚Ð¸ 312 Ð¸ Ð±ÑƒÐ»ÐµÐ²Ñ‹Ð¹ Ð²ÐµÐºÑ‚Ð¾Ñ€ (Ñ€Ð°Ð·Ð¼ÐµÑ€Ð½Ð¾ÑÑ‚Ð¸ 739), Ð¾Ñ‚Ð²ÐµÑ‡Ð°ÑŽÑ‰Ð¸Ð¹ Ð·Ð° ÑÑ‚Ð¾Ð»Ð±Ñ†Ñ‹ *title_has_{tag}* ÐºÐ¾Ð½ÐºÐ°Ñ‚ÐµÐ½Ð¸Ñ€Ð¾Ð²Ð°Ð»Ð¸ÑÑŒ Ð¸ Ð¿Ð¾Ð´Ð°Ð²Ð°Ð»Ð¸ÑÑŒ Ð½Ð° ÐºÐ»Ð°ÑÑÐ¸Ñ„Ð¸ÐºÐ°Ñ‚Ð¾Ñ€, Ð¿Ñ€ÐµÐ´ÑÑ‚Ð°Ð²Ð»ÑÑŽÑ‰Ð¸Ð¹ Ð¸Ð· ÑÐµÐ±Ñ Ð¿ÐµÑ€ÑÐµÐ¿Ñ‚Ñ€Ð¾Ð½ Ñ 2 ÑÐºÑ€Ñ‹Ñ‚Ñ‹Ð¼Ð¸ ÑÐ»Ð¾ÑÐ¼Ð¸ (Ñ€Ð°Ð·Ð¼ÐµÑ€Ð½Ð¾ÑÑ‚Ð¸ 512 Ð¸ 512). 

ÐÐµÐ¹Ñ€Ð¾ÑÐµÑ‚ÑŒ Ð¾Ð±ÑƒÑ‡Ð°Ð»Ð°ÑÑŒ Ñ Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒÑŽ Ð¾Ð¿Ñ‚Ð¸Ð¼Ð¸Ð·Ð°Ñ‚Ð¾Ñ€Ð° AdamW Ñ lr=1e-3 Ð½Ð° ÐºÐ»Ð°ÑÑÐ¸Ñ„Ð¸ÐºÐ°Ñ‚Ð¾Ñ€Ðµ Ð¸ lr=1e-4 Ð½Ð° Ð‘ÐµÑ€Ñ‚Ðµ.

## ÐšÑ€Ð¾ÑÑ-Ð²Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸Ñ
Ð˜Ñ‚Ð¾Ð³Ð¾Ð²Ð°Ñ Ð¼Ð¾Ð´ÐµÐ»ÑŒ Ð¿Ñ€ÐµÐ´ÑÑ‚Ð°Ð²Ð»ÑÐµÑ‚ Ð¸Ð· ÑÐµÐ±Ñ Ð°Ð½ÑÐ°Ð¼Ð±Ð»ÑŒ Ð¸Ð· 5 Ð½ÐµÐ¹Ñ€Ð¾ÑÐµÑ‚ÐµÐ¹, Ð¾Ð±ÑƒÑ‡ÐµÐ½Ð½Ñ‹Ñ… Ð½Ð° Ñ‚Ñ€ÐµÐ½Ð¸Ñ€Ð¾Ð²Ð¾Ñ‡Ð½Ð¾Ð¹ Ð²Ñ‹Ð±Ð¾Ñ€ÐºÐµ Ñ Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒÑŽ StratifiedKFold. 

**F1-Ð¼ÐµÑ‚Ñ€Ð¸ÐºÐ°** Ð½Ð° Ð²Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸Ð¾Ð½Ð½Ð¾Ð¹ Ð²Ñ‹Ð±Ð¾Ñ€ÐºÐµ Ð½Ð° ÐºÐ°Ð¶Ð´Ð¾Ð¹ Ð¸Ð· Ð½ÐµÐ¹Ñ€Ð¾ÑÐµÑ‚ÐµÐ¹ ÑÐ¾ÑÑ‚Ð°Ð²Ð¸Ð»Ð°: 
0.8651, 0.8661, 0.8663, 0.8646, 0.8673

ÐœÐµÑ‚Ð¾Ð´Ð¸ÐºÐ° Ð³Ð¾Ð»Ð¾ÑÐ¾Ð²Ð°Ð½Ð¸Ñ:
1. Ð•ÑÐ»Ð¸ ÐµÑÑ‚ÑŒ Ð¿Ñ€ÐµÐ´ÑÐºÐ°Ð·Ð°Ð½Ð¸Ðµ Ñ Ñ‚Ñ€ÐµÐ¼Ñ Ð¸ Ð±Ð¾Ð»ÐµÐµ Ð³Ð¾Ð»Ð¾ÑÐ°Ð¼Ð¸ - Ð±ÐµÑ€ÐµÐ¼ ÐµÐ³Ð¾
2. Ð•ÑÐ»Ð¸ ÐµÑÑ‚ÑŒ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð¾Ð´Ð½Ð¾ Ð¿Ñ€ÐµÐ´ÑÐºÐ°Ð·Ð°Ð½Ð¸Ðµ Ñ Ð´Ð²ÑƒÐ¼Ñ Ð³Ð¾Ð»Ð¾ÑÐ°Ð¼Ð¸, Ð° Ð¾ÑÑ‚Ð°Ð»ÑŒÐ½Ñ‹Ðµ Ð¿Ð¾ Ð¾Ð´Ð½Ð¾Ð¼Ñƒ Ð³Ð¾Ð»Ð¾ÑÑƒ - Ð±ÐµÑ€ÐµÐ¼ Ñ Ð´Ð²ÑƒÐ¼Ñ Ð³Ð¾Ð»Ð¾ÑÐ°Ð¼Ð¸
3. Ð•ÑÐ»Ð¸ ÐµÑÑ‚ÑŒ Ð´Ð²Ð° Ð¿Ñ€ÐµÐ´ÑÐºÐ°Ð·Ð°Ð½Ð¸Ñ Ñ Ð´Ð²ÑƒÐ¼Ñ Ð³Ð¾Ð»Ð¾ÑÐ°Ð¼Ð¸ Ñƒ ÐºÐ°Ð¶Ð´Ð¾Ð³Ð¾ - Ð²Ñ‹Ð±Ð¸Ñ€Ð°ÐµÐ¼ ÑÑ€ÐµÐ´Ð¸ Ð´Ð²ÑƒÑ… Ð¿Ñ€ÐµÐ´ÑÐºÐ°Ð·Ð°Ð½Ð¸Ð¹ Ñ‚Ð¾, Ñƒ ÐºÐ¾Ñ‚Ð¾Ñ€Ð¾Ð³Ð¾ Ð²Ñ‹ÑˆÐµ ÑÑƒÐ¼Ð¼Ð° Ð´Ð²ÑƒÑ… Ð²ÐµÑ€Ð¾ÑÑ‚Ð½Ð¾ÑÑ‚ÐµÐ¹ ("ÑÐ¸Ð» Ð³Ð¾Ð»Ð¾ÑÐ¾Ð²")
4. Ð•ÑÐ»Ð¸ Ð²ÑÐµ Ð¿Ñ€ÐµÐ´ÑÐºÐ°Ð·Ð°Ð½Ð¸Ñ Ð¿Ð¾ Ð¾Ð´Ð½Ð¾Ð¼Ñƒ Ð³Ð¾Ð»Ð¾ÑÑƒ - Ð±ÐµÑ€ÐµÐ¼ Ñ Ð½Ð°Ð¸Ð±Ð¾Ð»ÑŒÑˆÐµÐ¹ Ð²ÐµÑ€Ð¾ÑÑ‚Ð½Ð¾ÑÑ‚ÑŒÑŽ 


## Ð˜Ñ‚Ð¾Ð³Ð¸. Ð¢Ð¾Ñ‡ÐºÐ¸ Ñ€Ð¾ÑÑ‚Ð°
- ÐžÐ±ÑƒÑ‡ÐµÐ½Ð½Ñ‹Ð¹ Ð°Ð½ÑÐ°Ð¼Ð±Ð»ÑŒ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ Ð² ÐºÐ°Ñ‡ÐµÑÑ‚Ð²Ðµ Ð²Ñ…Ð¾Ð´Ð½Ñ‹Ñ… Ð´Ð°Ð½Ð½Ñ‹Ñ… Ñ‚Ð¾Ð»ÑŒÐºÐ¾ *title* Ð¸ *description*. Ð”Ð»Ñ ÑƒÐ»ÑƒÑ‡ÑˆÐµÐ½Ð¸Ñ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹ Ð¼Ð¾Ð´ÐµÐ»Ð¸ Ð½ÑƒÐ¶Ð½Ð¾ Ð¿Ñ‹Ñ‚Ð°Ñ‚ÑŒÑÑ Ð¿Ñ€Ð¸Ð¼ÐµÐ½Ð¸Ñ‚ÑŒ Ñ„Ð¾Ñ‚Ð¾Ð³Ñ€Ð°Ñ„Ð¸Ð¸ Ñ‚Ð¾Ð²Ð°Ñ€Ð° Ð² Ð¿Ñ€ÐµÐ´ÑÐºÐ°Ð·Ð°Ð½Ð¸Ð¸. ÐÐ°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, Ð²Ð·ÑÑ‚ÑŒ Ð±Ð¾Ð»ÐµÐµ ÑÐ»Ð¾Ð¶Ð½ÑƒÑŽ Ð°Ñ€Ñ…Ð¸Ñ‚ÐµÐºÑ‚ÑƒÑ€Ñƒ (ViT Ð¸ Ñ‚.Ð´.)

- Ð£Ð»ÑƒÑ‡ÑˆÐ¸Ñ‚ÑŒ Ð¿Ñ€ÐµÐ´Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÑƒ Ñ‚ÐµÐºÑÑ‚Ð¾Ð². Ð’ Ñ‡Ð°ÑÑ‚Ð½Ð¾ÑÑ‚Ð¸, Ð·Ð°Ð¼ÐµÐ½ÑÑ‚ÑŒ Ñ€ÐµÐ´ÐºÐ¸Ðµ ÑÐ¸Ð½Ð¾Ð½Ð¸Ð¼Ñ‹, Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð¾Ð±Ð»ÐµÐ³Ñ‡Ð¸Ñ‚ÑŒ Ð¶Ð¸Ð·Ð½ÑŒ Ð½ÐµÐ¹Ñ€Ð¾ÑÐµÑ‚Ð¸ (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, Ð²ÐµÐ»Ð¾ÑÐ¸Ð¿ÐµÐ´ÐºÐ¸ - ÑˆÐ¾Ñ€Ñ‚Ñ‹)

- Ð’Ð²ÐµÑÑ‚Ð¸ Ð´Ñ€ÑƒÐ³Ð¾Ð¹ Ð»Ð¾ÑÑ, ÑƒÑ‡Ð¸Ñ‚Ñ‹Ð²Ð°ÑŽÑ‰Ð¸Ð¹ Ð²Ð»Ð¾Ð¶ÐµÐ½Ð½Ð¾ÑÑ‚ÑŒ Ð¿Ð¾Ð´ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸Ð¹ (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, Ð¿Ð¾ÑÑ‚Ñ€Ð¾Ð¸Ñ‚ÑŒ Ð´ÐµÑ€ÐµÐ²Ð¾ Ð²Ð»Ð¾Ð¶ÐµÐ½Ð½Ð¾ÑÑ‚ÐµÐ¹ Ð¸ ÑÐ¼Ð¾Ñ‚Ñ€ÐµÑ‚ÑŒ Ñ€Ð°ÑÑÑ‚Ð¾ÑÐ½Ð¸Ðµ Ð¾Ñ‚ Ð¿Ñ€ÐµÐ´Ð¸ÐºÑ‚Ð° Ð´Ð¾ Ð¸ÑÑ‚Ð¸Ð½Ñ‹) Ð¸ Ð½Ð°Ð»Ð¸Ñ‡Ð¸Ðµ Ð¾Ð´Ð¸Ð½Ð°ÐºÐ¾Ð²Ñ‹Ñ… Ð¿Ð¾Ð´ÐºÐ°Ñ‚ÐµÐ³Ð¾Ð³Ð¾Ñ€Ð¸Ð¹ Ð² Ñ€Ð°Ð·Ð½Ñ‹Ñ… ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸ÑÑ… (Ð»Ð¾Ð½Ð³ÑÐ»Ð¸Ð²Ñ‹ Ð¶ÐµÐ½ÑÐºÐ¸Ðµ Ð¸ Ð´ÐµÑ‚ÑÐºÐ¸Ðµ Ð±ÑƒÐ´ÑƒÑ‚ Ð² Ð³Ñ€Ð°Ñ„Ðµ Ð½Ð°Ñ…Ð¾Ð´Ð¸Ñ‚ÑÑ Ð´Ð°Ð»ÐµÐºÐ¾, Ð½Ð¾ ÑÐ¼Ñ‹ÑÐ» Ñƒ Ð½Ð¸Ñ… Ð±Ð»Ð¸Ð·ÐºÐ¸Ð¹)

- ÐŸÑ€Ð¸Ð²ÐµÑÑ‚Ð¸ Ñ€Ð°ÑÐ¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð¸Ñ ÐºÐ»Ð°ÑÑÐ¾Ð² Ðº Ð±Ð°Ð»Ð°Ð½ÑÑƒ

- *custom_characteristics*, *defined_characteristics*, *filters* - Ñ„Ð°ÐºÑ‚ Ð½Ð°Ð»Ð¸Ñ‡Ð¸Ñ ÐºÐ°ÐºÐ¾Ð³Ð¾ Ñ‚Ð¾ ÑÐ²Ð¾Ð¹ÑÑ‚Ð²Ð° Ñƒ Ñ‚Ð¾Ð²Ð°Ñ€Ð° Ð¼Ð¾Ð¶Ð½Ð¾ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ ÐºÐ°Ðº Ð±Ð¸Ð½Ð°Ñ€Ð½ÑƒÑŽ Ñ…Ð°Ñ€Ð°ÐºÑ‚ÐµÑ€Ð¸ÑÑ‚Ð¸ÐºÑƒ (ÐºÐ°Ðº Ñ‚ÐµÐ³Ð¸ Ð´Ð»Ñ title)

_______

### P.S. ÐŸÐ¾Ñ‡ÐµÐ¼Ñƒ Ð½Ðµ Ñ€Ð°ÑÑÐ¼Ð¾Ñ‚Ñ€ÐµÐ½Ñ‹ Ð´Ñ€ÑƒÐ³Ð¸Ðµ Ñ„Ð¸Ñ‡Ð¸

- *product_id*, *shop_id* - Ð¿Ñ€Ð¾ÑÑ‚Ð¾ Ð¸Ð½Ð´ÐµÐºÑÑ‹ Ð² Ð±Ð°Ð·Ðµ Ð´Ð°Ð½Ð½Ñ‹Ñ… ÑÐ°Ð¹Ñ‚Ð°
- *attributes* Ð² Ð±Ð¾Ð»ÑŒÑˆÐ¸Ð½ÑÑ‚Ð²Ðµ ÑÐ²Ð¾ÐµÐ¼ Ð´ÑƒÐ±Ð»Ð¸Ñ€ÑƒÑŽÑ‚ÑÑ Ð² *description*
- *rating* ÑÐ²Ð½Ð¾ Ð½Ðµ Ð´Ð¾Ð»Ð¶ÐµÐ½ Ð±Ñ‹Ñ‚ÑŒ ÑÐºÐ¾Ñ€Ñ€ÐµÐ»Ð¸Ñ€Ð¾Ð²Ð°Ð½ Ñ Ñ‚Ð°Ñ€Ð³ÐµÑ‚Ð¾Ð¼ (Ð²ÐµÐ´ÑŒ Ð¾Ñ‚ Ñ€Ð¾ÑÑ‚Ð° Ñ€ÐµÐ¹Ñ‚Ð¸Ð½Ð³Ð° Ñ‚Ð¾Ð²Ð°Ñ€Ð°, ÐµÐ³Ð¾ ÐºÐ»Ð°ÑÑ Ð½Ðµ Ð¼ÐµÐ½ÑÐµÑ‚ÑÑ)
- *shop_title* - Ñ‡Ð°Ñ‰Ðµ Ð²ÑÐµÐ³Ð¾ Ð½Ð°Ð·Ð²Ð°Ð½Ð¸Ðµ Ð±Ñ€ÐµÐ½Ð´Ð° Ð¸Ð»Ð¸ Ð²Ñ‹Ð´ÑƒÐ¼Ð°Ð½Ð½Ð¾Ðµ ÑÐ»Ð¾Ð²Ð¾. Ð˜Ð¼ÐµÐµÑ‚ Ð¼Ð°Ð»Ð¾ Ð¾Ð±Ñ‰ÐµÐ³Ð¾ Ñ ÐºÐ»Ð°ÑÑÐ¾Ð¼ Ñ‚Ð¾Ð²Ð°Ñ€Ð°


### P.P.S. ÐŸÑ€Ð¸Ð¼ÐµÑ€Ñ‹ Ð½ÐµÐ¾Ð´Ð½Ð¾Ð·Ð½Ð°Ñ‡Ð½Ð¾ÑÑ‚ÐµÐ¹ Ð½Ð° Ñ‚ÐµÑÑ‚Ð¾Ð²Ð¾Ð¹ Ð²Ñ‹Ð±Ð¾Ñ€ÐºÐµ.
ÐšÐ¾Ð½ÐµÑ‡Ð½Ð¾, Ñ Ð½ÐµÐ¼Ð½Ð¾Ð³Ð¾ Ð¿Ð¾Ð´Ð³ÑÐ½ÑƒÐ» Ð² Ñ‚ÐµÑÑ‚Ð¾Ð²ÑƒÑŽ Ð²Ñ‹Ð±Ð¾Ñ€ÐºÑƒ, Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð¾Ñ†ÐµÐ½Ð¸Ñ‚ÑŒ ÐºÐ°Ðº Ð²Ð¾Ð¾Ð±Ñ‰Ðµ Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚ Ð¼Ð¾Ð´ÐµÐ»ÑŒ. Ð’Ð¾Ñ‚ Ð½ÐµÑÐºÐ¾Ð»ÑŒÐºÐ¾ Ð¸Ð½Ñ‚ÐµÑ€ÐµÑÐ½Ñ‹Ñ… Ð¿Ñ€Ð¸Ð¼ÐµÑ€Ð¾Ð², Ð³Ð´Ðµ Ð´Ð°Ð¶Ðµ Ñ Ð½Ðµ Ð¼Ð¾Ð³Ñƒ Ð¾Ð´Ð½Ð¾Ð·Ð½Ð°Ñ‡Ð½Ð¾ Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»Ð¸Ñ‚ÑŒ ÐºÐ»Ð°ÑÑ.

**"Ð”ÐµÐºÐ¾Ñ€Ð°Ñ‚Ð¸Ð²Ð½Ð°Ñ Ñ‚Ð°Ð±Ð»Ð¸Ñ‡ÐºÐ° ÐŸÑ€Ð°Ð²Ð¸Ð»Ð° ÐºÑƒÑ…Ð½Ð¸ Ð¿Ð¾Ð´ÑÑ‚Ð°Ð²ÐºÐ° Ð¿Ð¾Ð´ Ð³Ð¾Ñ€ÑÑ‡ÐµÐµ, Ñ€Ð°Ð·Ð´ÐµÐ»Ð¾Ñ‡Ð½Ð°Ñ Ð´Ð¾ÑÐºÐ°" (id 1668662)**

Ð¡ÑƒÐ´Ñ Ð¿Ð¾ Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸ÑŽ Ð¸Ð·Ð´ÐµÐ»Ð¸Ðµ Ð¼Ð¾Ð¶Ð½Ð¾ ÐºÐ°Ðº Ð¿Ñ€Ð¸ÐºÐ»ÐµÐ¸Ñ‚ÑŒ Ð½Ð° Ð´Ð²ÑƒÑÑ‚Ð¾Ñ€Ð¾Ð½Ð½Ð¸Ð¹ ÑÐºÐ¾Ñ‚Ñ‡, Ñ‚Ð°Ðº Ð¸ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ ÐºÐ°Ðº Ñ€Ð°Ð·Ð´ÐµÐ»Ð¾Ñ‡Ð½ÑƒÑŽ Ð´Ð¾ÑÐºÑƒ.

Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚: Ð½ÐµÐ¹Ñ€Ð¾Ð½ÐºÐ° Ð½Ðµ Ð¼Ð¾Ð¶ÐµÑ‚ Ð²Ñ‹Ð±Ñ€Ð°Ñ‚ÑŒ Ð¼ÐµÐ¶Ð´Ñƒ "Ð¢Ð°Ð±Ð»Ð¸Ñ‡ÐºÐ¸, Ð½Ð¾Ð¼ÐµÑ€Ð° Ð¸ ÐºÑ€ÑŽÑ‡ÐºÐ¸" Ð¸ "Ð Ð°Ð·Ð´ÐµÐ»Ð¾Ñ‡Ð½Ñ‹Ðµ Ð´Ð¾ÑÐºÐ¸"

**"Ð¢Ð¾Ð¿ Ð§ÐµÐ±Ð¾ÐºÑÐ°Ñ€ÑÐºÐ¸Ð¹ Ñ‚Ñ€Ð¸ÐºÐ¾Ñ‚Ð°Ð¶" (id 342378)**

ÐÐµÐ¹Ñ€Ð¾Ð½ÐºÐ° Ð½Ðµ Ð¼Ð¾Ð¶ÐµÑ‚ Ð²Ñ‹Ð±Ñ€Ð°Ñ‚ÑŒ Ð¼ÐµÐ¶Ð´Ñƒ "ÐœÐ°Ð¹ÐºÐ¸ Ð¸ Ñ‚Ð¾Ð¿Ñ‹ Ð±ÐµÐ»ÑŒÐµÐ²Ñ‹Ðµ", Ð¤ÑƒÑ‚Ð±Ð¾Ð»ÐºÐ¸ Ð¸ Ñ‚Ð¾Ð¿Ñ‹->Ð¢Ð¾Ð¿Ñ‹

